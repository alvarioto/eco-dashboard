{% set title = 'Emisiones Dashboard' %}
{% set filename = 'emisiones.html' %}

{% extends 'src/layouts/master.html' %}

{% block styles %}
<link rel="stylesheet" href="/assets/scss/iconly.scss">
<style>
    .page-content {
        padding: 20px;
    }

    .row {
        display: flex;
        gap: 15px;
        justify-content: space-between;
        align-items: stretch;
        flex-wrap: wrap;
    }

    .card {
        padding: 10px;
        border-radius: 8px;
        box-shadow: 0px 4px 8px rgba(0, 0, 0, 0.1);
        background-color: #fff;
        border: 1px solid #e0e0e0;
        flex: 1 1 30%;
        min-width: 250px;
        display: flex;
        flex-direction: column;
        justify-content: center;
        align-items: center;
        text-align: center;
        overflow: hidden;
    }

    .card-dark {
        background-color: #004e60;
        color: white;
        font-size: 14px;
        font-weight: bold;
        line-height: 1.2;
    }

    .card-header {
        font-weight: bold;
        font-size: 12px;
        margin-bottom: 5px;
    }

    .card-body {
        font-size: 12px;
    }

    .btn-employee {
        background-color: #004e60;
        color: white;
        border: none;
        padding: 6px 10px;
        border-radius: 5px;
        cursor: pointer;
        font-size: 10px;
    }

    .small-text {
        font-size: 10px;
        font-weight: normal;
        color: #6c757d;
    }

    /* Estilo para los gráficos */
    .chart-container {
        display: flex;
        gap: 10px;
        justify-content: space-between;
    }

    .chart-card {
        width: 48%;
        padding: 10px;
        border: 1px solid #e0e0e0;
        border-radius: 8px;
        background-color: white;
        text-align: center;
    }

    .chart-header {
        font-size: 12px;
        font-weight: bold;
        margin-bottom: 5px;
    }

    canvas {
        max-width: 100%;
        max-height: 200px;
    }

    /* Estilo para los Alcances */
    .alcances-row {
        display: flex;
        justify-content: space-between;
        gap: 20px;
        margin-top: 20px;
    }

    .card-alcance {
        flex: 1;
        padding: 15px;
        border-radius: 8px;
        box-shadow: 0px 4px 8px rgba(0, 0, 0, 0.1);
        background-color: #fff;
        border: 1px solid #e0e0e0;
    }

    .progress-group {
        margin-top: 10px;
    }

    .progress {
        height: 10px;
        background-color: #e9ecef;
        border-radius: 5px;
        margin-bottom: 10px;
    }

    .progress-bar {
        height: 10px;
        border-radius: 5px;
    }
</style>
{% endblock %}

{% block content %}
<div class="page-content">
    <div class="row">
        <!-- Emisiones totales -->
        <div class="card card-dark">
            <div>Emisiones totales <br> 97,05 kg CO₂e</div>
        </div>

        <!-- Emisiones por empleado -->
        <div class="card">
            <div class="card-header">Emisiones por empleado</div>
            <div class="card-body">
                <p class="small-text">Datos insuficientes</p>
                <button class="btn-employee">Añadir número de empleados</button>
            </div>
        </div>

        <!-- Emisiones por actividad -->
        <div class="card">
            <div class="card-header">Emisiones por actividad</div>
            <div class="card-body">
                <p>10 kg CO₂e</p>
                <p class="small-text">10% vs el periodo anterior</p>
            </div>
        </div>
    </div>

    <!-- Gráficos -->
    <div class="chart-container">
        <!-- Emisiones por alcance -->
        <div class="chart-card">
            <div class="chart-header">Emisiones por alcance</div>
            <canvas id="emisionesAlcance"></canvas>
        </div>

        <!-- Evolución mensual por alcance -->
        <div class="chart-card">
            <div class="chart-header">Evolución mensual por alcance</div>
            <canvas id="evolucionMensual"></canvas>
        </div>
    </div>

    <!-- Nueva sección de Alcances alineados horizontalmente -->
    <div class="alcances-row">
        <!-- Alcance 1 -->
        <div class="card-alcance">
            <div class="card-header">Alcance 1</div>
            <div class="card-body">
                <p><strong>0,84%</strong> de tus emisiones</p>
                <p class="small-text">0,81 / 97,05 kg CO₂e</p>
                <div class="progress-group">
                    <span>Transporte</span>
                    <div class="progress">
                        <div class="progress-bar" role="progressbar" style="width: 100%; background-color: #6c757d;"></div>
                    </div>
                    <span>Maquinaria Móvil</span>
                    <div class="progress">
                        <div class="progress-bar" role="progressbar" style="width: 0%;"></div>
                    </div>
                    <span>Emisiones Fugitivas</span>
                    <div class="progress">
                        <div class="progress-bar" role="progressbar" style="width: 0%;"></div>
                    </div>
                    <span>Instalaciones Fijas</span>
                    <div class="progress">
                        <div class="progress-bar" role="progressbar" style="width: 0%;"></div>
                    </div>
                </div>
            </div>
        </div>

        <!-- Alcance 2 -->
        <div class="card-alcance">
            <div class="card-header">Alcance 2</div>
            <div class="card-body">
                <p><strong>99,16%</strong> de tus emisiones</p>
                <p class="small-text">966,23 / 97,05 kg CO₂e</p>
                <div class="progress-group">
                    <span>Electricidad</span>
                    <div class="progress">
                        <div class="progress-bar" role="progressbar" style="width: 60%; background-color: #f9b56a;"></div>
                    </div>
                    <span>Calor y Vapor</span>
                    <div class="progress">
                        <div class="progress-bar" role="progressbar" style="width: 20%;"></div>
                    </div>
                    <span>Instalaciones de energía renovable</span>
                    <div class="progress">
                        <div class="progress-bar" role="progressbar" style="width: 10%;"></div>
                    </div>
                </div>
            </div>
        </div>

        <!-- Alcance 3 -->
        <div class="card-alcance">
            <div class="card-header">Alcance 3</div>
            <div class="card-body">
                <p><strong>0%</strong> de tus emisiones</p>
                <p class="small-text">0 / 973,05 kg CO₂e</p>
                <div class="progress-group">
                    <span>Operaciones Empresariales</span>
                    <div class="progress">
                        <div class="progress-bar" role="progressbar" style="width: 20%;"></div>
                    </div>
                    <span>Bienes y servicios</span>
                    <div class="progress">
                        <div class="progress-bar" role="progressbar" style="width: 40%;"></div>
                    </div>
                    <span>Agua</span>
                    <div class="progress">
                        <div class="progress-bar" role="progressbar" style="width: 10%;"></div>
                    </div>
                    <span>Productos Vendidos</span>
                    <div class="progress">
                        <div class="progress-bar" role="progressbar" style="width: 0%;"></div>
                    </div>
                    <span>Viajes de Negocios</span>
                    <div class="progress">
                        <div class="progress-bar" role="progressbar" style="width: 0%;"></div>
                    </div>
                    <span>Residuos</span>
                    <div class="progress">
                        <div class="progress-bar" role="progressbar" style="width: 0%;"></div>
                    </div>
                    <span>Bienes de capital</span>
                    <div class="progress">
                        <div class="progress-bar" role="progressbar" style="width: 20%;"></div>
                    </div>
                    <span>Desplazamiento de Empleados</span>
                    <div class="progress">
                        <div class="progress-bar" role="progressbar" style="width: 10%;"></div>
                    </div>
                    <span>Transporte y distribución</span>
                    <div class="progress">
                        <div class="progress-bar" role="progressbar" style="width: 44%;"></div>
                    </div>
                    <span>Gestión de Activos</span>
                    <div class="progress">
                        <div class="progress-bar" role="progressbar" style="width: 0%;"></div>
                    </div>
                    <span>Actividades Relacionadas con el Combustible y la Energía</span>
                    <div class="progress">
                        <div class="progress-bar" role="progressbar" style="width: 0%;"></div>
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>

<!-- Script para generar los gráficos con Chart.js -->
<script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
<script>
    // Gráfico de anillo: Emisiones por alcance
    const ctx1 = document.getElementById('emisionesAlcance').getContext('2d');
    const emisionesAlcance = new Chart(ctx1, {
        type: 'doughnut',
        data: {
            labels: ['Alcance 1', 'Alcance 2', 'Alcance 3'],
            datasets: [{
                label: 'Emisiones por alcance',
                data: [4.84, 99.16, 22],
                backgroundColor: ['#6cd3bd', '#f9b56a', '#5fb4e6'],
                hoverOffset: 4
            }]
        },
        options: {
            responsive: true,
            plugins: {
                legend: {
                    position: 'right',
                }
            }
        }
    });

    // Gráfico de línea: Evolución mensual por alcance
    const ctx2 = document.getElementById('evolucionMensual').getContext('2d');
    const evolucionMensual = new Chart(ctx2, {
        type: 'line',
        data: {
            labels: ['Ene', 'Feb', 'Mar', 'Abr', 'May', 'Jun', 'Jul', 'Ago', 'Sep', 'Oct', 'Nov', 'Dic'],
            datasets: [{
                label: 'Alcance 1',
                data: [1, 54, 0, 0, 0, 0, 23, 0, 2, 0, 12, 0],
                borderColor: '#6cd3bd',
                backgroundColor: 'rgba(108, 211, 189, 0.2)',
                fill: true
            }, {
                label: 'Alcance 2',
                data: [12, 80, 97, 42, 32, 0, 41, 0, 0, 0, 0, 0],
                borderColor: '#f9b56a',
                backgroundColor: 'rgba(249, 181, 106, 0.2)',
                fill: true
            }, {
                label: 'Alcance 3',
                data: [13, 0, 0, 30, 0, 0, 12, 7, 0, 6, 4, 0],
                borderColor: '#5fb4e6',
                backgroundColor: 'rgba(95, 180, 230, 0.2)',
                fill: true
            }]
        },
        options: {
            responsive: true,
            scales: {
                x: {
                    beginAtZero: true
                },
                y: {
                    beginAtZero: true,
                    max: 100
                }
            },
            plugins: {
                legend: {
                    position: 'top',
                }
            }
        }
    });
</script>
{% endblock %}



